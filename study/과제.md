# 네트워크 장비의 종류와 역할

## 랜카드

- NIC(Network Interface Card)라고도 한다.
- PC or 네트워크에서 전달되어오는 정보를 상호 교환할 수 있도록 함.

## 허브(HUB)
- 집중화 장비(Concentrator)라고도 함.
- 단순히 노드들을 연결시켜주는 역할.
- 주로 노드들은 UTP 케이블을 통해서 연결
  - UTP : Unshielded Twisted-Pair, 절연체로 감싸여있지 않은 꼬인 쌍선을 의미한다. STP보다는 가격이 싸다
  - STP : Shielded Twisted-Pair, 절연체로 감싸여진 케이블도 있다. 성능이 좋지만 가격이 비쌈.
- 간단하게, 네트워크에 붙어있는 PC들을 한 곳으로 모아주는 역할.

## 리피터(Repeter)
- 전송거리에 따른 신호감쇄를 보상하기 위해 전자기 또는 광학 전송매체 상에서 신호를 수신하고 증폭하여 매체의 다음 구간으로 재전송 시키는 장치.
- 즉, 신호감쇄가 발생해도 증폭시켜서 멀리 보내고자 함.
- 신호감쇄의 영향을 받아도 멀리 신호를 보낼 수 있다.

## 브리지(Bridge)
- 리피터와 달리 패킷 프레임에 대한 인지능력이 있으며 OSI의 데이터링크계층인 MAC에서 동작하며, 둘 이상의 네트워크를 상호 연결하는데 사용.
- 네트워크를 확장시키고, 네트워크 통신을 격리시키기 위해서 사용

## 라우터(Router)
- 인터넷에서 IP 네트워크들 간을 연결하거나 IP네트워크와 인터넷을 연결하기 위해 사용하는 장비
- 네트워크계층에서 동작.
- 이기종 LAN간의 연결, LAN을 WAN에 연결과 효율적인 경로를 선택하는 라이팅 기능 및 에러 패킷에 대한 폐기등의 기능을 가짐.


## 게이트웨이(Gateway)
- 서로 다른 통신규약을 사용하는 네트워크들을 상호연결하기 위하여 자신의 통신규약을 상대방의 통신규약으로 전화해주는 역할
- 즉, 서로 다른 기종의 네트워크 장비를 연결시켜주는 장비

## Modem
- (디지털 신호 -> 아날로그 신호) or (아날로그 신호 -> 디지털 신호)로 변환하는 장치
- Modulation + Demodulation

## 멀티플랙서(Multiplex, MUX)
- 전송 효율을 높이기 위해 여러개의 전송신호를 하나로 묶어 통신 채널을 통해 전송할 수 있게 하는 장비.(N input -> 1 output)

참고 : https://dany-it.tistory.com/148


# 네트워크 장비의 대표적인 회사가 어디인가

- 2020년 3분기 세계 이동통신장비 시장 점유율
  1. 에릭슨(32%) 
  2. 화웨이(30.5%)
  3. 노키아(19.8%)
  4. ZTE(10.4%)
  5. 삼성전자(4.6%)

참고 : http://m.ddaily.co.kr/m/m_article/?no=206090

# NAT가 무엇인가

WebRTC를 공부하다가 NAT 단어가 나와서 조사하게 됨.

- 네트워크 주소 변환(Network Address Translation)이라 함.
- IP 패킷의 TCP/UDP 포트 숫자와 소스 및 목적지의 IP 주소 등을 재기록하면서 라우터를 통해 네트워크 트래픽을 주고 받는 기술.
- 사용 이유 : 사설 네트워크에 속한 여러 개의 호스트가 하나의 공인 IP 주소(ex> 인터넷)를 사용하여 인터넷에 접속하기 위함.
- NAT가 호스트 간의 통신에 있어서 복잡성을 증가시킬 수 있으므로 네트워크 성능에 영향을 줄 수 있음.
- IPv4의 주소 부족 문제를 해결하기 위한 방법으로 고려됨.
- 즉, 내부 망에서는 사설 IP 주소를 사용하여 통신을 하고,<BR>
외부망과의 통신시에는 NAT를 거쳐 공인 IP 주소로 자동 변환.

- NAT 사용 목적
  1. 인터넷의 공인 IP 주소 절약
     - 인터넷 공인 IP주소는 한정적이기 때문에 절약해야 됨.
     - NAT을 이용하면 사설 IP주소를 사용하면서 이를 공인 IP주소와 상호변환할 수 있도록 하여, 공인 IP주소를 다수가 함께 사용할 수 있도록 함.
  2. 인터넷이라는 공공망과 연결되는 사용자들의 고유한 사설망을 침입자들로부터 보호. 
     - 공개된 인터넷 - 사설망 사이 방화벽을 설치하여 외부 공격으로부터 사용자의 통신망을 보호하는 기본적인 수단으로 활용할 수 있다.
     - 이때, 외부 통신망(즉, 인터넷망)과 연결하는 장비인 라우터에 NAT를 설정할 경우 라우터는 자신에게 할당된 공인 IP주소만 외부로 알려지게 하고, 내부에서는 사설 IP주소만 사용하도록 하여 필요시에 이를 서로 변환시켜줌.
     - 따라서, 외부 침입자가 공격하기 위해서는 사설망의 내부 시설 IP주소를 알아야 하기 때문에 공격이 불가능해지므로 내부 네트워크를 보호.


참고 : https://jwprogramming.tistory.com/30

# IPv4 private address
사설망이란 ip address를 사설 ip 주소로 사용하는 네트워크 이다.

IPv4는 4 * 8bit address로 총 32bit(4bytes)의 주소를 가질 수 있다.

(0~255).(0~255).(0~255).(0~255)의 형태로 나타내며 이 ip주소를 통해 통신시, destination 네트워크의 주소를 알 수 있게 된다.

하지만 IPv4의 개수는 유한하다. 이러한 유한한 개수의 ip주소를 각각 PC마다 할당시켜 준다면 IPv4 주소를 전부 사용하게 되고 어떠한 네트워크는 ip주소를 할당받지 못하게 된다.

IPv4의 개수를 아끼기 위해 **IPv4 private address**가 탄생했다.

사설망은 고정 ip 네트워크에 연결된 다른 기기들의 ip주소는 그 네트워크 내부에서만 사용하는 ip주소로 바꾸어서 사용해준다.

쉽게 생각해서 공유기에 많은 장치들을 연결한다고 생각하면 될 것 같다. 따라서 주 사용처는 기업이나 가정에서 많이 사용한다.

PC 두대를 하나의 공유기에 연결하여 각각 ip 주소를 확인해본다면 192.168.0.n1, 192.168.0.n2 이렇게 나오게 될 것이다. 이는 private address를 할당받은것이다.

그렇다면 공유기는 하나의 고유 ip address를 가지고 있고 두대의 PC는 공유기를 통하여 다른 네트워크로 접속 할수있게 된다.

아래 내용은 private addres의 종류를 참조한것이다.

RFC1918 이름|IP 주소 범위|주소 개수|클래스 내용|최대 사이더 블록 (서브넷 마스크)|호스트 ID 크기|
|----------|------------------|-----------------|----------------------|-----------------------------|--------------|
|24비트 블록|	10.0.0.0 – 10.255.255.255|16,777,216|클래스 A 하나|10.0.0.0/8 (255.0.0.0)|24 비트|
|20비트 블록|	172.16.0.0 – 172.31.255.255	|1,048,576	|16개의 인접 클래스 B	|172.16.0.0/12 (255.240.0.0)	|20 비트|
|16비트 블록|	192.168.0.0 – 192.168.255.255|	65,536	|256개의 인접 클래스 C	|192.168.0.0/16 (255.255.0.0)	|16 비트|

클래스는 각각 클래스마다 가질 수 있는 IP주소의 크기가 정해져있다.

클래스 A는 a.b.c.0 ~ a.b.c.255개로 총 256개의 IP주소를 가질수 있다.

private address를 구하는것은 단순 비트 연산이기 때문에 구체적으로 언급하지는 않겠다.

# 파이썬 비동기 처리(Asynchronous)

참고 : https://www.daleseo.com/python-asyncio/

## 동시 프로그래밍의 패러다임의 변화

동시 프로그래밍(Concurrent Programming)
- 여러 개의 thread를 활용하여 이루어짐.
- thread safe한 프로그램 작성은 쉬운일이아님.
- 싱글 코어 프로세서에서 이러한 프로그램을 돌리면, 기대했던 동시 처리에 따른 성능 향상이 미미하거나 성능 저하되기도 함.

이러한 이유로 최근에 하나의 쓰레드로 동시 처리를 하는 비동기 프로그래밍(asynchronous programming)이 주목받는중.

## 비동기 프로그래밍

CPU 연산 대비 DB나 API와 연동 과정에서 발생하는 대기 시간이 긴데, 비동기 프로그래밍은 이러한 대기 시간을 낭비하지 않고 그 시간에 CPU가 다른 처리를 할 수 있도록 하는데 이를 `non-blocking`이라 한다.

`javascript` 언어가 비동기 방식으로 동작하도록 설계된 언어이다.

`python`의 경우 기본적으로 동기 방식으로 동작하는 언어이다.

하지만 python3.4에서 `asyncio`가 표준 라이브러리로 추가되고, python3.5에서 `async/await` 키워드가 문법으로 채택 되면서, 자체적으로 비동기 프로그래밍이 가능해짐.

## 핵심 문법

`def` 키워드
- 함수 선언, 동기 방식으로 동작

`asnyc def` 키워드 
- 함수가 비동기 처리되며, 이러한 비동기 함수를 파이썬에서는 `coroutine`이라 함.
- 이러한 비동기 함수는 호출하면 coroutine 객체가 리턴됨.
- 비동기 함수는 일반적으로 `asnyc`로 선언된 다른 비동기 함수 내에서 `await` 키워드를 붙여서 호출해야 함.

```python
asnyc def do_async():
    pass

async def main_async:
    await do_async()
```

- `async`로 선언되지 않은 일반 동기 함수 내에서 비동기 함수를 호출하려며 `asyncio` 라이브러리의 이벤트 루프를 이용해야함.
```python
loop = asyncio.get_event_loop() # event loop를 얻음
loop.run_until_complete(main_async()) # main_async()가 끝날 때까지 기다림
loop.close() #event loop 닫음
```
그러나 파이썬 3.7이상에서는 간단하게 바뀜
```python
asyncio.run(main_async())
```

기본적으로 비동기 처리는 정확히 실행 순서가 보장되지 않는다. 비록 동일한 실행 순서를 보장받지 못하더라도, 여기서 중요한 점은 CPU를 놀리지 않고 불필요한 지연없이 요청이 실행되어야 한다는 것이다.

`async with` 키워드
- async with은 클래스나 함수를 비동기로 처리한 후 결과를 반환함.
- async with은 클래스의 인스턴스를 지정하고 as 저장할 변수를 지정함.
```python
async with class() as var:
  ~
```
- async with을 사용하려면 __aenter__와 __aexit__ 메서드를 구현해야함.
```python
class var:
  async def __aenter__(self):
      code
  
  async def __aexit__(self, type, val, trace):
      code
```

`async for` 키워드
- async for는 비동기로 반복함.
- async with과 마찬가지로 메서드를 구현해야함.
```python
class var:
  def __aiter__(self):
      return self
  
  async def __anext__(self, type, val, trace):
      if ~ :
            code
      
      else:
            raise StopAsyncIteration # 반복을 끝내고 싶을 때 예외를 발생시킴
  
```
참고 : https://dojang.io/mod/page/view.php?id=2469
